{% load static %}

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1, width=device-width" />

    <link rel="stylesheet" href="{% static 'css/movies.css' %}" />
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Nunito Sans:wght@600;700;800&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Signika:wght@500&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Open Sans:wght@600;700&display=swap"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
    />
  </head>
  <body>
    <div>
          <!-- Modal -->
    <div class="modal fade" id="contactModal" tabindex="-1" role="dialog" aria-labelledby="contactModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
          <div class="modal-content">
              <div class="modal-header">
                  <h5 class="modal-title" id="contactModalLabel"> Add Movie </h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                  </button>
              </div>
              <div class="modal-body">
                  <form id="contactForm" method="post">

                      <div class="form-group">
                          <label for="name"> Movie Title </label>
                          <input type="text" class="form-control" id="title" name="title" required>
                      </div>

                    <div class="modal--body">
                      <label for="email">Genre</label>
                      <select id="dataDropdown" class="form-control">
                        <option value="option"> Select...</option>
                      </select>


                    </div>
                      <div class="form-group" style="margin-top: 20px">
                        <label for="email">Price</label>
                        <input type="integer" class="form-control"name="price" id="price" required>
                    </div>

                    <div style="display: flex; flex-direction: column; gap:10px; margin-top:10px">
                      <label> Upload thumbnail </label>
                      <input type="file" name="file" id="file" accept=".png" required>
                    </div>



                      <div class="py-4">
                        <button type="submit" class="btn btn-primary btn-block py-2">Add Movie </button>
                      </div>
                  
                  </form>
                  <div id="formResponse" class="mt-3"></div>
              </div>
          </div>
      </div>
  </div>

      


    </div>



    <div class="dashboard-11">
      <div class="main">
        <div class="content">
          <div class="center">
            <img
              class="data-icon"
              loading="lazy"
              alt=""
              src="{% static './public/frame.svg'%}"
            />
          </div>
          <div class="navigation-sidebar-menu-li2">
            <div class="menu-items-container">
              <div class="item-container-parent">
                <div class="item-container">
                  <div class="hide-bg-copy4"></div>
                </div>


              <a href="{% url 'home' %}" class="menu-item-link" style="text-decoration: none; color:#000"> 
                <div class="menu-itemstandard3">
                  <div class="menu-item-content">
                    <img
                      class="icon8"
                      loading="lazy"
                      alt=""
                      src="{% static './public/icon11.svg' %}"/>

                    <div class="label">
                      <b class="menu-item3">Dashboard</b>
                    </div>
                  </div>
                </div>
              </a>
            </div>

          <a href="{% url 'customers' %}" class="menu-item-link" style="text-decoration: none">
              <div class="frame-parent11">
                <div class="hide-bg-copy-wrapper1">
                  <div class="hide-bg-copy6"></div>
                </div>

                <div class="menu-itemstandard5">
                  <div class="iconlyregularlight3-user-group">
                    <img
                      class="iconlyregularlight3-user1"
                      alt=""
                      src="{% static './public/iconlyregularlight3-users.svg'%}"/>
                    <div class="menu-item-wrapper1">
                      <b class="menu-item4">Customers</b>
                    </div>
                  </div>
                </div>
              </div>
            </a>


            <a href="{% url 'movies' %}" class="menu-item-link" style="text-decoration: none; color: #fff; font-weight: 500">
              <div class="frame-parent11">
                <div class="hide-bg-copy-wrapper1">
                  <div class="hide-bg-copy5"></div>
                </div>
                <div class="menu-itemstandard4">
                  <div class="bx-movie-playsvg-group">
                    <img
                      class="bx-movie-playsvg-icon1"
                      alt=""
                      src="{% static './public/bxmovieplaysvgs.svg'%}"
                    />

                    <div class="menu-item-wrapper2">
                      <b class="menu-item5">Movies</b>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </a>


            <img
              class="divider-icon3"
              loading="lazy"
              alt=""
              src="{% static './public/divider-2.svg'%}"
            />
          </div>
        </div>
      </div>

      
      <div class="navigation-sidebar-menu-li3">
        <div class="side-bar-bg1"></div>
        <div class="products34">
          <div class="hide-bg17"></div>
          <div class="products35">Logout</div>
          <div class="div19"></div>
        </div>
        <div class="products36">
          <div class="hide-bg18"></div>
          <div class="products37">Settings</div>
          <div class="div20"></div>
        </div>
        <img class="divider-icon4" alt="" src="{% static './public/divider.svg'%}" />

        





      
        <div class="navigation-sidebar-item-li1">
          <div class="products66">
            <div class="hide-bg-hide-bg-copy-mask1">
              <div class="mask1"></div>
              <div class="hide-bg33"></div>
              <div class="hide-bg-copy7"></div>
            </div>
            <div class="products67">Dashboard</div>
            <div class="div35"></div>
          </div>
        </div>
        <div class="logo1">
          <div class="bg6"></div>
          <div class="bright-web2">
            <span>Dash</span>
            <span class="stack1">Stack</span>
          </div>
        </div>
      </div>
      <div class="table-container">
        <div class="data-table">
          <div class="tablebg"></div>
          <div class="header1">
            <div class="search-container">
              <div class="search-input">
                <div class="search-label">
                  <b class="customers">Movies</b>
                </div>
                <button class="buttons-filled-no-icon-m" id="add"  data-toggle="modal" data-target="#contactModal">
                  <b class="add-customer">Add Movies</b>
                </button>
              </div>
              <div class="form-elements-inputfields">
                <div class="bg7"></div>
                <div class="bg8"></div>
                <input class="input-label" placeholder="Search" type="text" />

                <div class="padding-10px-10px">Padding 10px 10px 10px 14px</div>
                <img
                  class="vuesaxlinearsearch-normal-icon"
                  alt=""
                  src="{% static './public/vuesaxlinearsearchnormal.svg'%}"
                />
              </div>
            </div>
          </div>














          <!-- Table Content -->
          <div class="body-container">
            <div class="body3">
            </div>



            
            <!-- Table Header -->
    <div class="thead">
        <div class="id-header">
            <input class="checkbox13" type="checkbox" />
            <div class="id-label">
                <div class="id">Movie ID</div>
            </div>
        </div>
        <div class="name-header" style="margin-left: -60px">
            <div class="name-label">
                <div class="name1">Movie Title</div>
            </div>
        </div>
        <div class="header-cell" style="margin-left: -100px">
            <div class="contact">Movie Type</div>
        </div>
        <div class="header-cell1">
            <div class="email1">Price </div>
        </div>

        

        <div class="header-cell1">
          <div class="email1">Actions </div>
      </div>
        

    </div>
            <!-- Table head end-->


            <!-- Table Rows  -->

            <!-- Table Rows end  -->
          </div>

          <div class="tbody">
            <div class="row">
              <div class="id-header">
                  <input class="checkbox13" type="checkbox" />
                  <div class="id-label" style="margin-left: -160px">
                      <div class="id">1</div>
                  </div>
              </div>
              <div class="name-header" style="margin-left: -140px">
                  <div class="name-label">
                      <div class="name1">John</div>
                  </div>
              </div>

              <div class="header-cell" style="margin-left: -40px">
                  <div class="contact">Doe</div>
              </div>

              <div class="header-cell" style="margin-left: -60px">
                <div class="contact">Doe</div>
            </div>

  


              <div class="action-header">
                  <div class="actions" style="margin-left:100px">
                      <button class="btn btn-primary">Edit</button>
                     <button class="btn btn-secondary">Delete</button>
                  </div>

                  
              </div>
          </div>



          </div>




          




          
        </div>


        






        

<!-- Table header end -->





        <div class="main-content">
          <main class="main-bg-color1">
            <section class="main-bg1"></section>
          </main>
          <div class="nav1">
            <div class="header2">
              <div class="search1"></div>
              <div class="header-content">
                <div class="text2">
                  <b class="title2">Hi, Aliyon!</b>
                  <div class="body4">Let’s check your progress today</div>
                </div>
              </div>
              <div class="profile-container">
                <div class="profile-content">
                  <div class="divider1"></div>
                </div>
                <div class="profile1">
                  <div class="avatar3">
                    <div class="avatar4">
                      <div class="avatar5">
                        <img
                          class="outline-border-icon1"
                          alt=""
                          src="{% static './public/outline-border.svg'%}"
                        />

                        <img
                          class="image-icon1"
                          alt=""
                          src="{% static './public/image@2x.png'%}"
                        />

                        <div class="initials2">
                          <div class="background3"></div>
                          <div class="initials3">AB</div>
                        </div>
                        <div class="icon9">
                          <div class="background4"></div>
                          <img
                            class="essentials-user-circle1"
                            loading="lazy"
                            alt=""
                            src="{% static './public/essentials--usercircle.svg'%}"
                          />
                        </div>
                        <div class="add1">
                          <div class="background5"></div>
                          <img
                            class="basics-add1"
                            alt=""
                            src="{% static './public/basics--add.svg'%}"
                          />
                        </div>
                        <div class="counter-top1">
                          <div class="large4">
                            <div class="base6"></div>
                            <div class="div53">23</div>
                          </div>
                          <div class="medium4">
                            <div class="base7"></div>
                            <b class="b14">12</b>
                          </div>
                          <div class="small4">
                            <div class="base8"></div>
                            <b class="b15">17</b>
                          </div>
                        </div>
                        <div class="counter-bottom1">
                          <div class="large5">
                            <div class="base9"></div>
                            <div class="div54">23</div>
                          </div>
                          <div class="medium5">
                            <div class="base10"></div>
                            <b class="b16">12</b>
                          </div>
                          <div class="small5">
                            <div class="base11"></div>
                            <b class="b17">17</b>
                          </div>
                        </div>
                        <img
                          class="bottom-plus-icon1"
                          alt=""
                          src="{% static './public/bottom-plus.svg'%}"
                        />

                        <div class="indicator-bottom1">
                          <div class="large6"></div>
                          <div class="medium6"></div>
                          <div class="small6"></div>
                        </div>
                        <div class="indicator-top1">
                          <div class="large7"></div>
                          <div class="medium7"></div>
                          <div class="small7"></div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="text-frame">
                    <div class="text3">
                      <b class="title3">Aliyon Tembo</b>
                      <div class="body5">Admin</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="name2">
                <img class="search-icon1" alt="" src="{% static './public/search.svg'%}" />

                <div class="body6">Search...</div>
              </div>
              <img class="icon10" alt="" src="{% static './public/icon.svg'%}" />

              <img class="icon11" alt="" src="{% static './public/icon.svg'%}" />
            </div>
          </div>
          <img
            class="separator-icon1"
            loading="lazy"
            alt=""
            src="{% static './public/separator.sv'%}g"
          />
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.3/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>

    <script>
      $(document).ready(function(){
       // Load data into dropdown when modal is shown
        $('#contactModal').on('show.bs.modal', function() {
        console.log("Modal is being shown");
        
        $.ajax({
            url: '{% url "get_genres" %}',
            method: 'GET',
            success: function(data) {
                console.log('AJAX request successful');
                console.log('Genres data:', data);
                
                var dropdown = $('#dataDropdown');
                dropdown.empty();
                
                data.forEach(function(item) {
                    console.log('Processing item:', item.genre);
                    dropdown.append($('<option></option>').attr('value', item.genre).text(item.genre));
                });
            },
            error: function(xhr, status, error) {
                console.error('AJAX request failed');
                console.error('Status:', status);
                console.error('Error:', error);
                alert('Failed to load data');
            }
        });
    });
    

      //submit contact form
        $('#contactForm').on('submit', function(event){
            event.preventDefault();
            $.ajax({
                type: 'POST',
                url: '{% url "add_movie" %}',
                data: {
                    'title': $('#title').val(),
                    'type': $('#dataDropdown').val(),
                    'price': $('#price').val(),
                    'thumbnail': $('#file').val(),
                    'csrfmiddlewaretoken': '{{ csrf_token }}'
                },
                success: function(response){
                    $('#formResponse').text(response.message);
                    $('#contactForm')[0].reset();
                },
                error: function(response){
                    $('#formResponse').text('An error occurred. Please try again.');
                }
            });
        });
    });


      
      </script>
  </body>
</html>
